export CUDA_VISIBLE_DEVICES=1,2,3

nohup python difusco/train.py --task tsp --storage_path ./temp/ --diffusion_type categorical --sparse_factor -1 --auto_generate --auto_num_nodes 100 --auto_num_train 100000 --auto_num_val 1000 --auto_num_test 1000 --auto_two_opt_iterations 0 --do_train --pref_rl --resume_weight_only --ckpt_path ./checkpoints/tsp50_categorical.ckpt --num_epochs 10 --inference_diffusion_steps 50 --pref_decode_random_tiebreak --pref_decode_noise_scale 1e-3 --pref_num_start_nodes 8 --pref_pairs_per_graph 1 --wandb_logger_name PbDifusco_TSP_Categorical_Pref_RL --wandb_offline --batch_size 32 --pref_anchor_type l2sp --pref_anchor_weight 1e-5 --pref_freeze_bottom_layers 6 --learning_rate 5e-5 --pref_softlen_weight 0.05 --pref_softlen_degree_lambda 0.1 --fp16 > train_tsp_categorical_pref_rl.log 2>&1 &